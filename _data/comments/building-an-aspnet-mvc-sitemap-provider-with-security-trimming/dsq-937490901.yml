id: dsq-937490901
date: 2009-02-24T14:12:19.0000000+01:00
name: Nick Gieschen
avatar: https://disqus.com/api/users/avatars/Nick Gieschen.jpg
message: '<p>I found another problem if there are nested providers: If the current node is in the nested provider it is not reported correctly. So you need:</p><p>public override SiteMapNode FindSiteMapNode(HttpContext context)<br>{<br>// Node<br>SiteMapNode node = null;</p><p>foreach (var provider in providers)<br>{<br>node = provider.FindSiteMapNode(context);<br>if (node != null)<br>return node;<br>}<br>...<br>}</p><p>And in ProcessXMLNodes:</p><p>...<br>if (node.Name == ns + nodeName)<br>{<br>var providerName = GetAttributeValue(node.Attribute("provider"));<br>if (!string.IsNullOrEmpty(providerName))<br>{<br>var provider = new SiteMapPath { SiteMapProvider = providerName }.Provider;<br>if(!providers.Contains(provider))<br>providers.Add(provider);<br>AddNode(provider.RootNode, rootNode);<br>}<br>else<br>{<br>// If this is a normal siteMapNode then map the xml element<br>// to a SiteMapNode, and add the node to the current rootNode.<br>childNode = this.GetSiteMapNodeFromXMLElement(node);<br>AddNode(childNode, rootNode);<br>}<br>}<br>...</p><p>Thanks, this has saved me a ton of time.</p>'
