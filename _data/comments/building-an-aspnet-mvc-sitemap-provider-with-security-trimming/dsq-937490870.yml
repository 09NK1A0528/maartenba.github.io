id: dsq-937490870
date: 2008-10-02T07:58:36.0000000+02:00
name: Rei
avatar: https://disqus.com/api/users/avatars/Rei.jpg
message: "<p>Firstly many thanks for a great component!!!</p><p>One thing to note about the provider is that the method [b]IsAccessibleToUser[/b] creates an instance of a controller at:<br>[quote]<br>  IController controller = ControllerBuilder.Current.GetControllerFactory().CreateController(handler.RequestContext, mvcNode.Controller);<br>[/quote]</p><p>Now this is all nice and dandy, but if controller creation is expensive (ie: resolved from an ioc container) then you might create a small bottleneck at this point.</p><p>I tried a simple solution which i'm confortable with:</p><p>[quote]</p><p>        private readonly object _controllerCache = new object();<br>        private readonly Hashtable _controllers = new Hashtable();</p><p>        private IController GetConntroller(RequestContext context, string controllerName) {<br>            lock (_controllerCache) {<br>                IController controller;</p><p>                if (!_controllers.ContainsKey(controllerName)) {<br>                    controller = ControllerBuilder.Current.GetControllerFactory().CreateController(context, controllerName);<br>                    _controllers.Add(controllerName, controller);<br>                } else<br>                    controller = (IController)_controllers[controllerName];</p><p>                return controller;<br>            }<br>        }</p><p>and modified the the [b]IsAccessibleToUser[/b] method as follows:</p><p>        IController controller = GetConntroller(handler.RequestContext, mvcNode.Controller);;</p><p>[/quote]</p><p>Hope this helps anyone.</p>"
